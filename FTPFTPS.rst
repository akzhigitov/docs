FTP/FTPS-протокол
=================

ИНТЕГРАЦИЯ С ИСПОЛЬЗОВАНИЕМ ШАБЛОНА
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Общие положения
---------------

Интеграционный сервис предоставляет возможность просто и быстро создавать sms-рассылки путем формирования и копирования файлов в формате csv. Интеграция осуществляется путем выкладывания Клиентом файла в определенную папку на FTP- сервер Платформы. Пароль на папку должен сообщаться Клиенту безопасным способом. Сервис платформы 1 раз в 10 секунд проверяет папку на наличие архивного файла. При обнаружении файла происходит его обработка, после чего он удаляется с FTP-сервера. Если в папке присутствует много архивов, то сервис начинает обработку самого раннего файла. Файлы обрабатываются по очереди. 

ТОЧКА ДОСТУПА
-------------

FTP – сервер Платформы располагается по адресу: **ftp.integrationapi.net**

Техническая часть
-----------------

ФОРМАТ ПРИЕМА СООБЩЕНИЙ ПО FTP
------------------------------

Формат названия архива: [логин_Клиента]_[YYYYMMDDhhmmss].zip
Пример: guest_20120207231932.zip

Файлы для отправки должны быть упакованы в архив .zip без пароля и находиться в папке [sms]. Папка [sms] должна содержать два файла формата csv (данные разделяются символом «;» ). Кодировка всех файлов по умолчанию - UTF-8. При необходимости выкладывать файлы в другой кодировке, обратитесь в техподдержку. Структура архива:

* sms
* contacts.csv
* template.csv 

Первый файл должен называться contacts.csv

+----------------------+----------------+---------------------------------------------------------------------------+
| Наименование столбца | Обязательность |    Описание                                                               |
+======================+================+===========================================================================+
| phone                |  Да            |  Номера получателя сообщения в международном формате: код страны +        |
|                      |                |  код сети + номер телефона. Пример: 79031234567                           |
+----------------------+----------------+---------------------------------------------------------------------------+
| senddate             |  Нет           |  Дата и время отправки сообщения в формате YYYYMMDDThh:mm:ss              |
|                      |                |  (локальное время Клиента). Если сообщение нужно отправить сразу после    |
|                      |                |  получения файла, то поле должно содержать пустое значение. Значение этого| 
|                      |                |  поля является более приоритетным по сравнению со значением из файла      |
|                      |                |  template.csv. Если поле не заполнено, то при отправке должно браться     |
|                      |                |  значение из файла template.csv. Может учитывать часовой пояс абонента,   |
|                      |                |  если заполнено поле localtime в файле template.csv.                      |
|                      |                |  Пример: 2010-06-01T19:14:00                                              |
+----------------------+----------------+---------------------------------------------------------------------------+
| attr1                |  Нет           | Текстовое поле для подстановки в шаблон.                                  |
+----------------------+----------------+---------------------------------------------------------------------------+
| attrN                |  Нет           | N-е текстовое поле для подстановки в шаблон.                              |
+----------------------+----------------+---------------------------------------------------------------------------+

Второй файл должен называться template.csv (в файле должна быть только одна строка с данными).

